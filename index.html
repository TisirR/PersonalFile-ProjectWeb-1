<!DOCTYPE html>
<!-- saved from url=(0051)file:///C:/Users/q8972/Desktop/SelfwebTexting2.html -->
<html lang="zh-CN"><head>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
// ä½¿ç”¨æ‚¨çš„é…ç½®ä¿¡æ¯
const SUPABASE_URL = 'https://hjtxgmlzqmasdgzjpvja.supabase.co';
const SUPABASE_ANON_KEY = 'sb_publishable_n5Fv_PIfuEKm2CnmFZEBOA_AYs1IOJA';

// åˆå§‹åŒ– Supabase å®¢æˆ·ç«¯
try {
    // æ£€æŸ¥ supabase åº“æ˜¯å¦å·²åŠ è½½
    if (typeof supabase === 'undefined') {
        throw new Error('Supabase JS åº“æœªåŠ è½½æˆåŠŸ');
    }
    // åˆ›å»ºå®¢æˆ·ç«¯å¹¶èµ‹ç»™å…¨å±€å˜é‡
    window.supabase = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
    console.log('âœ… Supabase å®¢æˆ·ç«¯åˆå§‹åŒ–æˆåŠŸ');
} catch (error) {
    console.error('âŒ Supabase åˆå§‹åŒ–å¤±è´¥:', error);
    // è®¾ç½®ä¸€ä¸ªç©ºçš„å®¢æˆ·ç«¯ï¼Œä»¥ä¾¿åç»­ä»£ç ä¸ä¼šå› ä¸ºwindow.supabaseæœªå®šä¹‰è€ŒæŠ¥é”™
    window.supabase = null;
}
</script>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RB/Tisir_Rçš„ä¸ªäººç½‘é¡µ(TEXTING)</title>
    <style>
        body {
            font-family: 'Microsoft YaHei', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f0f2f5;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 900px;
            margin: 20px auto;
            padding: 20px;
            background: white;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
            border-radius: 10px;
        }
        
        header {
            text-align: center;
            padding: 40px 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 10px;
            margin-bottom: 30px;
            position: relative;
        }
        
        .avatar-container {
            position: relative;
            display: inline-block;
            margin-bottom: 20px;
        }
        
        .avatar {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            border: 5px solid white;
            overflow: hidden;
            cursor: pointer;
            transition: transform 0.3s ease;
        }
        
        .avatar:hover {
            transform: scale(1.05);
        }
        
        .avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .avatar-edit-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            opacity: 0;
            transition: opacity 0.3s ease;
            cursor: pointer;
        }
        
        .avatar-container:hover .avatar-edit-overlay {
            opacity: 1;
        }
        
        h1 {
            margin: 0 0 10px;
            font-size: 2.5em;
        }
        
        .tagline {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .section {
            margin: 30px 0;
            padding: 25px;
            border-left: 4px solid #667eea;
            background: #f9f9f9;
            border-radius: 0 8px 8px 0;
        }
        
        h2 {
            color: #667eea;
            margin-top: 0;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 10px;
        }
        
        .skills {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .skill {
            background: #667eea;
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            transition: transform 0.3s;
        }
        
        .skill:hover {
            transform: translateY(-3px);
        }
        
        footer {
            text-align: center;
            padding: 20px;
            margin-top: 30px;
            border-top: 1px solid #eee;
            color: #666;
        }
        
        /* æ¨¡æ€æ¡†æ ·å¼ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background: white;
            padding: 20px;
            border-radius: 10px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh; /* é™åˆ¶æœ€å¤§é«˜åº¦ */
            overflow-y: auto; /* æ·»åŠ æ»šåŠ¨æ¡ */
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }
        
        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        input, textarea {
            width: calc(100% - 22px); /* è€ƒè™‘paddingå’Œborder */
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-family: inherit;
            box-sizing: border-box; /* é‡è¦ï¼šåŒ…å«paddingå’Œborderåœ¨å®½åº¦å†… */
        }

        .btn-block {
            display: block;
            width: 100%;
            box-sizing: border-box; /* ç¡®ä¿æŒ‰é’®å®½åº¦è®¡ç®—ä¸€è‡´ */
        }
        
        textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        .btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background 0.3s;
        }
        
        .btn:hover {
            background: #5a6fd8;
        }
        
        .btn-block {
            display: block;
            width: 100%;
        }
        
        .btn-secondary {
            background: #6c757d;
        }
        
        .btn-secondary:hover {
            background: #5a6268;
        }
        
        .avatar-preview {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            object-fit: cover;
            margin: 10px auto;
            display: block;
            border: 2px solid #667eea;
        }
        
        .file-input-wrapper {
            position: relative;
            overflow: hidden;
            display: inline-block;
            width: 100%;
        }
        
        .file-input-wrapper input[type=file] {
            position: absolute;
            left: 0;
            top: 0;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }
        
        .file-input-btn {
            display: block;
            padding: 10px;
            background: #f8f9fa;
            border: 1px dashed #667eea;
            border-radius: 5px;
            text-align: center;
            color: #667eea;
            cursor: pointer;
        }
        
        .status-message {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            text-align: center;
            display: none;
        }
        
        .status-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .status-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        @media (max-width: 600px) {
            .container {
                margin: 10px;
                padding: 10px;
            }
            
            header {
                padding: 20px 0;
            }
            
            h1 {
                font-size: 2em;
            }
            
            .avatar {
                width: 120px;
                height: 120px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="avatar-container">
                <div class="avatar" id="avatarDisplay"><img src="" alt="ä¸ªäººå¤´åƒ"></div>
                <div class="avatar-edit-overlay" onclick="openPasswordModal('avatar')">
                    <span>ä¿®æ”¹å¤´åƒ</span>
                </div>
            </div>
            <h1 id="displayName">RB/Tisir_R</h1>
            <p class="tagline" id="displayTagline">è½¯ä»¶å·¥ç¨‹ä¸“ä¸šå­¦ç”Ÿ</p>
        </header>
        
        <section class="section">
            <h2>å…³äºæˆ‘</h2>
            <p id="displayAbout">Seriously?Does any one will really read this?
Painting,photographing,gaming,make videos&amp;try some thing new.</p>
        </section>
        
        <section class="section">
            <h2>æ•™è‚²èƒŒæ™¯</h2>
            <p id="displayEducation"><strong>HLJUniversity</strong> - è½¯ä»¶å·¥ç¨‹ä¸“ä¸š (2025-2029)</p>
            <p>ä¸»ä¿®è¯¾ç¨‹ï¼šCè¯­è¨€ç¨‹åºè®¾è®¡</p>
        </section>
        
        <section class="section">
            <h2>æˆ‘çš„æŠ€èƒ½</h2>
            <div class="skills" id="displaySkills"><div class="skill">åƒé¥­</div><div class="skill">ç¡è§‰</div><div class="skill">ç©æ¸¸æˆ</div><div class="skill">èŠå¤©</div><div class="skill">æ‘†å¼„AI</div><div class="skill">Photoshop</div></div>
        </section>
        
        <section class="section">
            <h2>æˆ‘çš„é¡¹ç›®</h2>
            <div id="displayProjects"><div style="margin-bottom: 20px; padding: 15px; background: white; border-radius: 8px; box-shadow: rgba(0, 0, 0, 0.1) 0px 2px 5px;">
                    <h3 style="margin-top: 0; color: #667eea;">ä¸»è¦æ´»è·ƒå¹³å°</h3>
                    <p style="margin-bottom: 0;">å¾®ä¿¡ï¼ŒQQï¼Œå“”å“©å“”å“©-Bilibili</p>
                </div><div style="margin-bottom: 20px; padding: 15px; background: white; border-radius: 8px; box-shadow: rgba(0, 0, 0, 0.1) 0px 2px 5px;">
                    <h3 style="margin-top: 0; color: #667eea;">ä¸ªäººåšå®¢ç½‘ç«™</h3>
                    <p style="margin-bottom: 0;">å“”å“©å“”å“© - https://b23.tv/aVa0VJY</p>
                </div><div style="margin-bottom: 20px; padding: 15px; background: white; border-radius: 8px; box-shadow: rgba(0, 0, 0, 0.1) 0px 2px 5px;">
                    <h3 style="margin-top: 0; color: #667eea;">X</h3>
                    <p style="margin-bottom: 0;">Tisir_Ré…ç»¥(@boringdiscover)ï¼šhttps://x.com/boringdiscover?t=r8mNBLzqwph4bi3aC2yG8w&amp;s=05</p>
                </div><div style="margin-bottom: 20px; padding: 15px; background: white; border-radius: 8px; box-shadow: rgba(0, 0, 0, 0.1) 0px 2px 5px;">
                    <h3 style="margin-top: 0; color: #667eea;">Pixiv</h3>
                    <p style="margin-bottom: 0;">Tisir_Rï¼ˆé…ç»¥ï¼‰https://www.pixiv.net/users/103936220</p>
                </div><div style="margin-bottom: 20px; padding: 15px; background: white; border-radius: 8px; box-shadow: rgba(0, 0, 0, 0.1) 0px 2px 5px;">
                    <h3 style="margin-top: 0; color: #667eea;">Github</h3>
                    <p style="margin-bottom: 0;">https://github.com/TisirR</p>
                </div></div>
        </section>
        
        <section class="section">
            <h2>è”ç³»æ–¹å¼</h2>
            <div id="displayContact"><p>ğŸ“§ é‚®ç®±ï¼šq8972111@gmail.com &amp; qtaisui8972111@163.com</p><p>ğŸ’¬ å¾®ä¿¡ï¼šq8972111</p><p>ğŸ§ QQï¼š8972111</p><p>âœ¨ Xï¼š@boringdiscover</p><p>ğŸ“± ä¸ªäººç”µè¯ï¼š+86 13763666360</p></div>
        </section>
        
        <section class="section">
            <h2>ç½‘ç«™è®¾ç½®</h2>
            <p>ä½ å¯ä»¥éšæ—¶ä¿®æ”¹ç½‘ç«™å†…å®¹ï¼Œæ‰€æœ‰æ›´æ”¹ä¼šè‡ªåŠ¨ä¿å­˜ã€‚</p >
            <button class="btn" onclick="openPasswordModal('edit')">ç¼–è¾‘å…¨éƒ¨å†…å®¹</button>
        </section>
        
        <footer>
            <p>Â© 2025 æˆ‘çš„ä¸ªäººç½‘é¡µ | æœ€åæ›´æ–°: <span id="last_updated">2025/11/26</span></p>
        </footer>
    </div>

    <!-- å¤´åƒç¼–è¾‘æ¨¡æ€æ¡† -->
    <div id="avatarModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ä¿®æ”¹å¤´åƒ</h3>
                <button class="close-btn" onclick="closeAvatarModal()">Ã—</button>
            </div>
            <div class="form-group">
                <label>é€‰æ‹©æ–°å¤´åƒ:</label>
                <div class="file-input-wrapper">
                    <div class="file-input-btn">ç‚¹å‡»é€‰æ‹©å›¾ç‰‡æ–‡ä»¶</div>
                    <input type="file" id="avatarUpload" accept="image/*">
                </div>
            </div>
            <div class="form-group">
                <label>å¤´åƒé¢„è§ˆ:</label>
                <img id="avatarPreview" class="avatar-preview" src="" alt="å¤´åƒé¢„è§ˆ">
            </div>
            <div id="avatarStatus" class="status-message"></div>
            <button class="btn btn-block" onclick="uploadAvatar()">æ›´æ–°å¤´åƒ</button>
        </div>
    </div>

    <!-- å¯†ç éªŒè¯æ¨¡æ€æ¡† -->
    <div id="passwordModal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 350px;">
            <div class="modal-header">
                <h3>è¯·è¾“å…¥ç¼–è¾‘å¯†ç </h3>
                <button class="close-btn" onclick="closePasswordModal()">&times;</button>
            </div>
            <div class="form-group">
                <label>å¯†ç :</label>
                <input type="password" id="passwordInput" placeholder="è¯·è¾“å…¥å¯†ç ">
            </div>
            <div id="passwordStatus" class="status-message"></div>
            <button class="btn btn-block" onclick="verifyPassword()">ç¡®è®¤</button>
        </div>
    </div>

    <!-- å†…å®¹ç¼–è¾‘æ¨¡æ€æ¡† -->
    <div id="editModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ç¼–è¾‘ç½‘ç«™å†…å®¹</h3>
                <button class="close-btn" onclick="closeEditModal()">Ã—</button>
            </div>
            <div class="form-group">
                <label>å§“å:</label>
                <input type="text" id="editName" placeholder="ä½ çš„å§“å">
            </div>
            <div class="form-group">
                <label>ä¸ªäººç®€ä»‹:</label>
                <input type="text" id="editTagline" placeholder="ä¸ªäººç®€ä»‹/èŒä¸š">
            </div>
            <div class="form-group">
                <label>ä¸ªç­¾:</label>
                <textarea id="editAbout" placeholder="å±•ç°ä½ çš„ä¸ªæ€§ä¿¡æ¯" style="height: 30px;"></textarea>
            </div>
            <div class="form-group">
                <label>æ•™è‚²èƒŒæ™¯:</label>
                <textarea id="editEducation" placeholder="æ•™è‚²èƒŒæ™¯ä¿¡æ¯" style="height: 45px;"></textarea>
            </div>
            <div class="form-group">
                <label>æŠ€èƒ½ (ç”¨é€—å·åˆ†éš”):</label>
                <input type="text" id="editSkills" placeholder="ä¾‹å¦‚: HTML, CSS, JavaScript">
            </div>
            <div class="form-group">
                <label>é¡¹ç›® (æ¯è¡Œä¸€ä¸ªé¡¹ç›®):</label>
                <textarea id="editProjects" placeholder="é¡¹ç›®åç§° - é¡¹ç›®æè¿°" style="height: 58px;"></textarea>
            </div>
            <div class="form-group">
                <label>è”ç³»æ–¹å¼ (æ¯è¡Œä¸€ä¸ª):</label>
                <textarea id="editContact" placeholder="ä¾‹å¦‚: é‚®ç®±: example@email.com" style="height: -6px;"></textarea>
            </div>
            <div id="editStatus" class="status-message status-success" style="display: none;">æ‰€æœ‰æ›´æ”¹å·²ä¿å­˜!</div>
            <button class="btn btn-block" onclick="saveChanges()">ä¿å­˜æ‰€æœ‰æ›´æ”¹</button>
        </div>
    </div>

    <script>

        // å¯†ç è®¾ç½®
        const EDIT_PASSWORD = "564646"; // ä½ å¯ä»¥ä¿®æ”¹è¿™ä¸ªå¯†ç 

        // é»˜è®¤æ•°æ®
        const defaultData = {
            name: "å¼ ä¸‰",
            tagline: "è®¡ç®—æœºä¸“ä¸šå­¦ç”Ÿ | ç½‘é¡µå¼€å‘å­¦ä¹ è€…",
            about: "æˆ‘æ˜¯ä¸€åå¯¹ç¼–ç¨‹å……æ»¡çƒ­æƒ…çš„è®¡ç®—æœºä¸“ä¸šå¤§å­¦ç”Ÿã€‚ç›®å‰æ­£åœ¨å­¦ä¹ ç½‘é¡µå¼€å‘ã€æ•°æ®ç»“æ„å’Œå„ç§ç¼–ç¨‹è¯­è¨€ã€‚æˆ‘ç›¸ä¿¡æŠ€æœ¯èƒ½å¤Ÿæ”¹å˜ä¸–ç•Œï¼Œå¸Œæœ›é€šè¿‡å­¦ä¹ ä¸æ–­æå‡è‡ªå·±ã€‚",
            education: "æŸæŸå¤§å­¦ - è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯ä¸“ä¸š (2022-2026)",
            skills: ["Cè¯­è¨€", "HTML/CSS", "JavaScript", "Python", "Photoshop", "æ•°æ®ç»“æ„"],
            projects: [
                { title: "å­¦ç”Ÿæˆç»©ç®¡ç†ç³»ç»Ÿ", description: "ä½¿ç”¨Cè¯­è¨€å¼€å‘çš„æ§åˆ¶å°åº”ç”¨ç¨‹åºï¼Œå®ç°äº†å­¦ç”Ÿä¿¡æ¯çš„å¢åˆ æ”¹æŸ¥ã€æˆç»©ç»Ÿè®¡å’Œæ’åºåŠŸèƒ½ã€‚" },
                { title: "ä¸ªäººåšå®¢ç½‘ç«™", description: "ä½¿ç”¨HTMLã€CSSå’ŒJavaScriptåˆ›å»ºçš„å“åº”å¼ä¸ªäººåšå®¢ç½‘ç«™ï¼Œé€‚é…æ‰‹æœºå’Œç”µè„‘ç«¯ã€‚" },
                { title: "è®¡ç®—å™¨åº”ç”¨", description: "åŸºäºJavaScriptå¼€å‘çš„ç½‘é¡µè®¡ç®—å™¨ï¼Œæ”¯æŒåŸºæœ¬æ•°å­¦è¿ç®—å’Œç•Œé¢äº¤äº’ã€‚" }
            ],
            contact: [
                "ğŸ“§ é‚®ç®±: zhangsan@example.com",
                "ğŸ“± å¾®ä¿¡: zhangsan123",
                "ğŸ± GitHub: zhangsan-github"
            ],
            avatar: null, // åˆå§‹æ²¡æœ‰å¤´åƒï¼Œä½¿ç”¨é»˜è®¤
            last_updated: new Date().toLocaleDateString('zh-CN')
        };

        // åˆå§‹åŒ–é¡µé¢
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
            document.getElementById('last_updated').textContent = new Date().toLocaleDateString('zh-CN');

            // ç›‘å¬å¯†ç è¾“å…¥æ¡†çš„Enteré”®
            document.getElementById('passwordInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    verifyPassword();
                }
            });
        });

        // ä»æ•°æ®åº“åŠ è½½æ•°æ® - ä¼˜åŒ–ç‰ˆ
        async function loadData() {
            try {
                console.log('æ­£åœ¨ä»SupabaseåŠ è½½æ•°æ®...');
                
                // ä»Supabaseè¯»å–æ•°æ®
                const { data, error } = await window.supabase
                    .from('website_data')
                    .select('*')
                    .eq('id', 1)
                    .single();
                    
                if (error) {
                    console.log('ä»æ•°æ®åº“åŠ è½½å¤±è´¥ï¼Œä½¿ç”¨æœ¬åœ°æ•°æ®:', error);
                    // é™çº§åˆ°æœ¬åœ°å­˜å‚¨
                    const savedData = localStorage.getItem('personalWebsiteData');
                    const data = savedData ? JSON.parse(savedData) : defaultData;
                    updatePageWithData(data);
                    return;
                }
                
                if (data) {
                    console.log('ä»æ•°æ®åº“åŠ è½½æ•°æ®æˆåŠŸ');
                    updatePageWithData(data);
                    
                    // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨ä½†ä¸åŒ…å«å¤§å°ºå¯¸çš„å¤´åƒæ•°æ®
                    const dataForLocalStorage = { ...data };
                    if (dataForLocalStorage.avatar && dataForLocalStorage.avatar.length > 10000) {
                        console.log('å¤´åƒæ•°æ®è¿‡å¤§ï¼Œä¸åœ¨æœ¬åœ°å­˜å‚¨ä¿å­˜');
                        delete dataForLocalStorage.avatar;
                    }
                    localStorage.setItem('personalWebsiteData', JSON.stringify(dataForLocalStorage));
                } else {
                    console.log('æ•°æ®åº“ä¸­æ²¡æœ‰æ•°æ®ï¼Œä½¿ç”¨é»˜è®¤æ•°æ®');
                    updatePageWithData(defaultData);
                }
            } catch (error) {
                console.log('åŠ è½½é”™è¯¯ï¼Œä½¿ç”¨æœ¬åœ°æ•°æ®:', error);
                const savedData = localStorage.getItem('personalWebsiteData');
                const data = savedData ? JSON.parse(savedData) : defaultData;
                updatePageWithData(data);
            }
        }

        // ç”¨æ•°æ®æ›´æ–°é¡µé¢
        function updatePageWithData(data) {
            // æ›´æ–°é¡µé¢æ˜¾ç¤º
            document.getElementById('displayName').textContent = data.name;
            document.getElementById('displayTagline').textContent = data.tagline;
            document.getElementById('displayAbout').textContent = data.about;
            document.getElementById('displayEducation').innerHTML = `<strong>${data.education.split(' - ')[0]}</strong> - ${data.education.split(' - ')[1]}`;
            
            // æ›´æ–°æŠ€èƒ½
            const skillsContainer = document.getElementById('displaySkills');
            skillsContainer.innerHTML = '';
            data.skills.forEach(skill => {
                const skillElement = document.createElement('div');
                skillElement.className = 'skill';
                skillElement.textContent = skill;
                skillsContainer.appendChild(skillElement);
            });
            
            // æ›´æ–°é¡¹ç›®
            const projectsContainer = document.getElementById('displayProjects');
            projectsContainer.innerHTML = '';
            data.projects.forEach(project => {
                const projectElement = document.createElement('div');
                projectElement.style.marginBottom = '20px';
                projectElement.style.padding = '15px';
                projectElement.style.background = 'white';
                projectElement.style.borderRadius = '8px';
                projectElement.style.boxShadow = '0 2px 5px rgba(0,0,0,0.1)';
                
                projectElement.innerHTML = `
                    <h3 style="margin-top: 0; color: #667eea;">${project.title}</h3>
                    <p style="margin-bottom: 0;">${project.description}</p >
                `;
                projectsContainer.appendChild(projectElement);
            });
            
            // æ›´æ–°è”ç³»æ–¹å¼
            const contactContainer = document.getElementById('displayContact');
            contactContainer.innerHTML = '';
            data.contact.forEach(contact => {
                const contactElement = document.createElement('p');
                contactElement.textContent = contact;
                contactContainer.appendChild(contactElement);
            });
            
            // æ›´æ–°å¤´åƒ
            updateAvatarDisplay(data.avatar);
            
            // å¡«å……ç¼–è¾‘è¡¨å•
            document.getElementById('editName').value = data.name;
            document.getElementById('editTagline').value = data.tagline;
            document.getElementById('editAbout').value = data.about;
            document.getElementById('editEducation').value = data.education;
            document.getElementById('editSkills').value = data.skills.join(', ');
            document.getElementById('editProjects').value = data.projects.map(p => `${p.title} - ${p.description}`).join('\n');
            document.getElementById('editContact').value = data.contact.join('\n');
        }

        // æ›´æ–°å¤´åƒæ˜¾ç¤º - ä¿®å¤ç‰ˆæœ¬
        function updateAvatarDisplay(avatarData) {
            const avatarDisplay = document.getElementById('avatarDisplay');
            const avatarPreview = document.getElementById('avatarPreview');
            
            console.log('updateAvatarDisplay è¢«è°ƒç”¨ï¼Œæ•°æ®é•¿åº¦:', avatarData ? avatarData.length : 0);
            
            // æ¸…ç©ºç°æœ‰å†…å®¹
            avatarDisplay.innerHTML = '';
            
            // æ£€æŸ¥æ•°æ®æœ‰æ•ˆæ€§
            if (!avatarData || 
                avatarData === 'null' || 
                avatarData === 'NULL' || 
                avatarData === '' ||
                typeof avatarData !== 'string') {
                console.log('å¤´åƒæ•°æ®ä¸ºç©ºæˆ–æ— æ•ˆï¼Œæ˜¾ç¤ºé»˜è®¤å¤´åƒ');
                showDefaultAvatar(avatarDisplay, avatarPreview);
                return;
            }
            
            // æ£€æŸ¥æ˜¯å¦æ˜¯ HTML ä»£ç ï¼ˆé”™è¯¯æƒ…å†µï¼‰
            if (avatarData.includes('<img') || avatarData.includes('style=') || avatarData.includes('alt=')) {
                console.error('âŒ é”™è¯¯ï¼šå¤´åƒæ•°æ®åŒ…å« HTML ä»£ç ');
                showDefaultAvatar(avatarDisplay, avatarPreview);
                return;
            }
            
            // æ£€æŸ¥æ˜¯å¦æ˜¯æœ‰æ•ˆçš„ Base64 å›¾ç‰‡æ•°æ®
            if (avatarData.startsWith('data:image')) {
                console.log('âœ… æ˜¾ç¤ºæœ‰æ•ˆçš„ Base64 å¤´åƒ');
                
                // åˆ›å»º img å…ƒç´ 
                const img = document.createElement('img');
                img.src = avatarData;
                img.alt = 'ä¸ªäººå¤´åƒ';
                img.style.width = '100%';
                img.style.height = '100%';
                img.style.objectFit = 'cover';
                img.style.borderRadius = '50%';
                
                // ç›´æ¥æ·»åŠ åˆ° DOM
                avatarDisplay.appendChild(img);
                
                if (avatarPreview) {
                    avatarPreview.src = avatarData;
                }
            } else {
                console.log('â„¹ï¸ ä½¿ç”¨é»˜è®¤å¤´åƒï¼Œæ•°æ®æ ¼å¼ä¸æ”¯æŒ');
                showDefaultAvatar(avatarDisplay, avatarPreview);
            }
        }

        // æ˜¾ç¤ºé»˜è®¤å¤´åƒçš„è¾…åŠ©å‡½æ•°
        function showDefaultAvatar(avatarDisplay, avatarPreview) {
            avatarDisplay.innerHTML = `
                <div style="width:100%;height:100%;background:linear-gradient(135deg, #667eea 0%, #764ba2 100%);display:flex;align-items:center;justify-content:center;color:white;font-weight:bold;border-radius:50%;">
                    å¤´åƒ
                </div>
            `;
            if (avatarPreview) {
                avatarPreview.src = '';
            }
        }

        // æ‰“å¼€å¤´åƒç¼–è¾‘æ¨¡æ€æ¡†
        function openAvatarModal() {
            document.getElementById('avatarModal').style.display = 'flex';
            
            // è®¾ç½®æ–‡ä»¶é€‰æ‹©äº‹ä»¶
            document.getElementById('avatarUpload').addEventListener('change', function(event) {
                const file = event.target.files[0];
                if (!file) return;
                
                if (!file.type.match('image.*')) {
                    showStatus('avatarStatus', 'è¯·é€‰æ‹©å›¾ç‰‡æ–‡ä»¶!', 'error');
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('avatarPreview').src = e.target.result;
                };
                reader.readAsDataURL(file);
            });
        }

        // å…³é—­å¤´åƒç¼–è¾‘æ¨¡æ€æ¡†
        function closeAvatarModal() {
            document.getElementById('avatarModal').style.display = 'none';
            document.getElementById('avatarUpload').value = '';
            hideStatus('avatarStatus');
        }

        // ä¼˜åŒ–ç‰ˆä¸Šä¼ å¤´åƒ - ä¸åœ¨æœ¬åœ°å­˜å‚¨ Base64 æ•°æ®
        async function uploadAvatar() {
            const fileInput = document.getElementById('avatarUpload');
            if (!fileInput.files[0]) {
                showStatus('avatarStatus', 'è¯·å…ˆé€‰æ‹©å›¾ç‰‡æ–‡ä»¶!', 'error');
                return;
            }
            
            // æ£€æŸ¥æ–‡ä»¶å¤§å°ï¼ˆé™åˆ¶åœ¨ 1MB ä»¥å†…ï¼‰
            const file = fileInput.files[0];
            if (file.size > 1024 * 1024) {
                showStatus('avatarStatus', 'å›¾ç‰‡æ–‡ä»¶å¤ªå¤§ï¼Œè¯·é€‰æ‹©å°äº 1MB çš„å›¾ç‰‡!', 'error');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = async function(e) {
                const avatarData = e.target.result;
                
                console.log('å¤´åƒæ•°æ®å¤§å°:', avatarData.length, 'å­—ç¬¦');
                
                try {
                    // ç›´æ¥ä¿å­˜åˆ° Supabaseï¼Œä¸å…ˆæ›´æ–°æœ¬åœ°å­˜å‚¨
                    const { data: currentData, error: fetchError } = await window.supabase
                        .from('website_data')
                        .select('*')
                        .eq('id', 1)
                        .single();
                        
                    if (fetchError) throw fetchError;
                    
                    const updateData = {
                        ...currentData,
                        avatar: avatarData,
                        last_updated: new Date().toISOString()
                    };
                    
                    // ä¿å­˜åˆ° Supabase
                    const { error } = await window.supabase
                        .from('website_data')
                        .upsert(updateData);
                        
                    if (error) throw error;
                    
                    console.log('âœ… å¤´åƒå·²ä¿å­˜åˆ°Supabase');
                    
                    // æ›´æ–°é¡µé¢æ˜¾ç¤ºï¼Œä½†ä¸åœ¨æœ¬åœ°å­˜å‚¨ä¿å­˜ Base64 æ•°æ®
                    updateAvatarDisplay(avatarData);
                    document.getElementById('lastUpdated').textContent = new Date().toLocaleDateString('zh-CN');
                    
                    // æ›´æ–°æœ¬åœ°å­˜å‚¨ï¼Œä½†ä¸åŒ…å«å¤´åƒæ•°æ®
                    const dataForLocalStorage = { ...updateData };
                    delete dataForLocalStorage.avatar; // ç§»é™¤å¤´åƒæ•°æ®
                    localStorage.setItem('personalWebsiteData', JSON.stringify(dataForLocalStorage));
                    
                    showStatus('avatarStatus', 'å¤´åƒæ›´æ–°æˆåŠŸ!', 'success');
                    
                    // 1ç§’åå…³é—­æ¨¡æ€æ¡†
                    setTimeout(() => {
                        closeAvatarModal();
                    }, 1000);
                    
                } catch (error) {
                    console.error('ä¿å­˜å¤´åƒåˆ°æ•°æ®åº“å¤±è´¥:', error);
                    showStatus('avatarStatus', 'å¤´åƒä¿å­˜åˆ°äº‘ç«¯å¤±è´¥', 'error');
                }
            };
            reader.readAsDataURL(file);
        }

        // æ‰“å¼€å¯†ç éªŒè¯æ¨¡æ€æ¡†
        function openPasswordModal(type) {
            window.passwordFor = type || 'edit'; // é»˜è®¤ä¸ºç¼–è¾‘å†…å®¹
            document.getElementById('passwordModal').style.display = 'flex';
            document.getElementById('passwordInput').focus();
        }

        // å…³é—­å¯†ç éªŒè¯æ¨¡æ€æ¡†
        function closePasswordModal() {
           document.getElementById('passwordModal').style.display = 'none';
            document.getElementById('passwordInput').value = '';
            hideStatus('passwordStatus');
        }

        // éªŒè¯å¯†ç 
        function verifyPassword() {
           const password = document.getElementById('passwordInput').value;

            if (password === EDIT_PASSWORD) {
                closePasswordModal();
                // æ£€æŸ¥æ˜¯ç¼–è¾‘å†…å®¹è¿˜æ˜¯ç¼–è¾‘å¤´åƒ
                if (window.passwordFor === 'avatar') {
                    openAvatarModal();
                } else {
                    openEditModal();
                }
            } else {
                showStatus('passwordStatus', 'å¯†ç é”™è¯¯ï¼Œè¯·é‡è¯•!', 'error');
                document.getElementById('passwordInput').value = '';
                document.getElementById('passwordInput').focus();
            }
        }

        // æ‰“å¼€å†…å®¹ç¼–è¾‘æ¨¡æ€æ¡†
        function openEditModal() {
            document.getElementById('editModal').style.display = 'flex';
        }

        // å…³é—­å†…å®¹ç¼–è¾‘æ¨¡æ€æ¡†
        function closeEditModal() {
            document.getElementById('editModal').style.display = 'none';
            hideStatus('editStatus');
        }

        // ä¿å­˜æ‰€æœ‰æ›´æ”¹ - ä¼˜åŒ–ç‰ˆï¼ˆé¿å…å­˜å‚¨é…é¢è¶…é™ï¼‰
        async function saveChanges() {
            // è·å–è¡¨å•æ•°æ®
            const name = document.getElementById('editName').value;
            const tagline = document.getElementById('editTagline').value;
            const about = document.getElementById('editAbout').value;
            const education = document.getElementById('editEducation').value;
            const skills = document.getElementById('editSkills').value.split(',').map(s => s.trim()).filter(s => s);
            const projectsText = document.getElementById('editProjects').value;
            const contact = document.getElementById('editContact').value.split('\n').filter(c => c.trim());
            
            // è§£æé¡¹ç›®
            const projects = [];
            if (projectsText) {
                projectsText.split('\n').forEach(line => {
                    const parts = line.split(' - ');
                    if (parts.length >= 2) {
                        projects.push({
                            title: parts[0].trim(),
                            description: parts.slice(1).join(' - ').trim()
                        });
                    } else if (line.trim()) {
                        projects.push({
                            title: line.trim(),
                            description: 'é¡¹ç›®æè¿°'
                        });
                    }
                });
            }
            
            // è·å–å½“å‰æ•°æ®ä½†ä¸åŒ…å«å¤§å°ºå¯¸çš„å¤´åƒ
            const savedData = localStorage.getItem('personalWebsiteData');
            const currentData = savedData ? JSON.parse(savedData) : defaultData;
            
            // åˆ›å»ºæ–°æ•°æ®å¯¹è±¡
            const newData = {
                name,
                tagline,
                about,
                education,
                skills,
                projects: projects.length > 0 ? projects : defaultData.projects,
                contact: contact.length > 0 ? contact : defaultData.contact,
                avatar: null, // ä¸é€šè¿‡æ–‡æœ¬ç¼–è¾‘æ›´æ–°å¤´åƒ
                last_updated: new Date().toISOString() // åªä¿ç•™è¿™ä¸€ä¸ªæ—¶é—´æˆ³
            };
            
            try {
                // æ£€æŸ¥ Supabase æ˜¯å¦å¯ç”¨
                if (!window.supabase || typeof window.supabase.from !== 'function') {
                    throw new Error('Supabase å®¢æˆ·ç«¯ä¸å¯ç”¨');
                }
                
                // ä¿å­˜åˆ°Supabaseæ•°æ®åº“
                const { error } = await window.supabase
                    .from('website_data')
                    .upsert({ 
                        id: 1,
                        ...newData
                    });
                    
                if (error) throw error;
                
                console.log('æ•°æ®å·²ä¿å­˜åˆ°Supabase');
                
                // æ›´æ–°æœ¬åœ°å­˜å‚¨ä½†ä¸åŒ…å«å¤§å°ºå¯¸æ•°æ®
                localStorage.setItem('personalWebsiteData', JSON.stringify(newData));
                
                // æ›´æ–°é¡µé¢æ˜¾ç¤º
                updatePageWithData(newData);
                document.getElementById('lastUpdated').textContent = new Date().toLocaleDateString('zh-CN');
                
                showStatus('editStatus', 'æ•°æ®å·²ä¿å­˜åˆ°äº‘ç«¯ï¼', 'success');
                
                // 1ç§’åå…³é—­æ¨¡æ€æ¡†
                setTimeout(() => {
                    closeEditModal();
                }, 1000);
                
            } catch (error) {
                console.error('ä¿å­˜åˆ°æ•°æ®åº“å¤±è´¥:', error);
                // é™çº§åˆ°æœ¬åœ°å­˜å‚¨
                localStorage.setItem('personalWebsiteData', JSON.stringify(newData));
                updatePageWithData(newData);
                document.getElementById('lastUpdated').textContent = new Date().toLocaleDateString('zh-CN');
                showStatus('editStatus', 'ä¿å­˜åˆ°äº‘ç«¯å¤±è´¥ï¼Œå·²ä¿å­˜åˆ°æœ¬åœ°', 'error');
            }
        }

        // æ˜¾ç¤ºçŠ¶æ€æ¶ˆæ¯
        function showStatus(elementId, message, type) {
            const element = document.getElementById(elementId);
            element.textContent = message;
            element.className = `status-message status-${type}`;
            element.style.display = 'block';
        }

        // éšè—çŠ¶æ€æ¶ˆæ¯
        function hideStatus(elementId) {
            document.getElementById(elementId).style.display = 'none';
        }

        // ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­
        window.addEventListener('click', function(event) {
            if (event.target === document.getElementById('avatarModal')) {
                closeAvatarModal();
            }
            if (event.target === document.getElementById('editModal')) {
                closeEditModal();
            }
            if (event.target === document.getElementById('passwordModal')) {
                closePasswordModal();
            }
        });
    </script>

</body></html>
